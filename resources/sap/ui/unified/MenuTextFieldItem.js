/*!
 * SAP UI development toolkit for HTML5 (SAPUI5/OpenUI5)
 * (c) Copyright 2009-2014 SAP SE or an SAP affiliate company. 
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare("sap.ui.unified.MenuTextFieldItem");jQuery.sap.require("sap.ui.unified.library");jQuery.sap.require("sap.ui.unified.MenuItemBase");sap.ui.unified.MenuItemBase.extend("sap.ui.unified.MenuTextFieldItem",{metadata:{library:"sap.ui.unified",properties:{"label":{type:"string",group:"Appearance",defaultValue:null},"icon":{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},"value":{type:"string",group:"Misc",defaultValue:null},"valueState":{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None}}}});jQuery.sap.require("sap.ui.unified.MenuItemBase");jQuery.sap.require("sap.ui.core.ValueStateSupport");(function(){sap.ui.unified.MenuTextFieldItem.prototype.render=function(r,i,m,I){var a=r,b=m.checkEnabled(i),c=i.getId();a.write("<li ");a.writeAttribute("class","sapUiMnuItm sapUiMnuTfItm"+(m.checkEnabled(i)?"":" sapUiMnuItmDsbl"));a.writeElementData(i);if(I.bAccessible){a.writeAttribute("role","menuitem");a.writeAttribute("aria-labelledby",m.getId()+" "+c+"-txt "+c+"-scuttxt");a.writeAttribute("aria-disabled",!b);a.writeAttribute("aria-posinset",I.iItemNo);a.writeAttribute("aria-setsize",I.iTotalItems)}a.write("><div class=\"sapUiMnuItmL\"></div>");a.write("<div class=\"sapUiMnuItmIco\">");if(i.getIcon()){a.writeIcon(i.getIcon())}a.write("</div>");a.write("<div id=\""+c+"-txt\" class=\"sapUiMnuItmTxt\">");a.write("<label id=\""+c+"-lbl\" for=\""+c+"-tf\" class=\"sapUiMnuTfItemLbl\">");a.writeEscaped(i.getLabel()||"");a.write("</label>");a.write("<div id=\""+c+"-str\" class=\"sapUiMnuTfItmStretch\"></div>");a.write("<div class=\"sapUiMnuTfItemWrppr\">");a.write("<input id=\""+c+"-tf\" tabindex=\"-1\" role=\"textbox\" aria-multiline=\"false\" aria-autocomplete=\"none\"");a.writeAttributeEscaped("value",i.getValue()||"");a.writeAttribute("class",b?"sapUiMnuTfItemTf sapUiMnuTfItemTfEnbl":"sapUiMnuTfItemTf sapUiMnuTfItemTfDsbl");if(!b){a.writeAttribute("disabled","disabled")}a.write("></input></div></div>");a.write("<div class=\"sapUiMnuItmR\"></div>");a.write("</li>")};sap.ui.unified.MenuTextFieldItem.prototype.hover=function(h,m){this.$().toggleClass("sapUiMnuItmHov",h);if(h&&m.checkEnabled(this)){var t=this;function f(){t.$("tf").focus()};if(sap.ui.Device.browser.internet_explorer&&sap.ui.Device.browser.version==8){setTimeout(f,0)}else{f()}}};sap.ui.unified.MenuTextFieldItem.prototype.onAfterRendering=function(){this._adaptSizes();this.setValueState(this.getValueState())};sap.ui.unified.MenuTextFieldItem.prototype.onsapup=function(e){this.getParent().focus();this.getParent().onsapprevious(e)};sap.ui.unified.MenuTextFieldItem.prototype.onsapdown=function(e){this.getParent().focus();this.getParent().onsapnext(e)};sap.ui.unified.MenuTextFieldItem.prototype.onsaphome=function(e){if(this._checkCursorPosForNav(false)){this.getParent().focus();this.getParent().onsaphome(e)}};sap.ui.unified.MenuTextFieldItem.prototype.onsapend=function(e){if(this._checkCursorPosForNav(true)){this.getParent().focus();this.getParent().onsapend(e)}};sap.ui.unified.MenuTextFieldItem.prototype.onsapescape=function(e){this.getParent().onsapescape(e)};sap.ui.unified.MenuTextFieldItem.prototype.onkeydown=function(e){e.stopPropagation()};sap.ui.unified.MenuTextFieldItem.prototype.onclick=function(e){if(!sap.ui.Device.system.desktop&&this.getParent().checkEnabled(this)){this.focus()}e.stopPropagation()};sap.ui.unified.MenuTextFieldItem.prototype.onsapenter=function(e){var v=this.$("tf").val();this.setValue(v);this.getParent().selectItem(this);e.preventDefault();e.stopPropagation()};sap.ui.unified.MenuTextFieldItem.prototype.setSubmenu=function(m){jQuery.sap.log.warning("The aggregation 'submenu' is not supported for this type of menu item.","","sap.ui.unified.MenuTextFieldItem");return this};sap.ui.unified.MenuTextFieldItem.prototype.setLabel=function(l){this.setProperty("label",l,true);this.$("lbl").text(l);this._adaptSizes();return this};sap.ui.unified.MenuTextFieldItem.prototype.setValue=function(v){this.setProperty("value",v,true);this.$("tf").val(v);return this};sap.ui.unified.MenuTextFieldItem.prototype.setValueState=function(v){this.setProperty("valueState",v,true);var $=this.$("tf");$.toggleClass("sapUiMnuTfItemTfErr",v==sap.ui.core.ValueState.Error);$.toggleClass("sapUiMnuTfItemTfWarn",v==sap.ui.core.ValueState.Warning);var t=sap.ui.core.ValueStateSupport.enrichTooltip(this,this.getTooltip_AsString());this.$().attr("title",t?t:"");return this};sap.ui.unified.MenuTextFieldItem.prototype.getFocusDomRef=function(){var f=this.$("tf");return f.length?f.get(0):null};sap.ui.unified.MenuTextFieldItem.prototype._adaptSizes=function(){var $=this.$("tf");var a=this.$("lbl");var o=a.length?a.get(0).offsetLeft:0;if(sap.ui.getCore().getConfiguration().getRTL()){$.parent().css({"width":"auto","right":(this.$().outerWidth(true)-o+(a.outerWidth(true)-a.outerWidth()))+"px"})}else{$.parent().css({"width":"auto","left":(o+a.outerWidth(true))+"px"})}};sap.ui.unified.MenuTextFieldItem.prototype._checkCursorPosForNav=function(f){var r=sap.ui.getCore().getConfiguration().getRTL();var b=f?r:!r;var $=this.$("tf");var p=$.cursorPos();var l=$.val().length;if(r){p=l-p}if((!b&&p!=l)||(b&&p!=0)){return false}return true}}());
